% !TEX root = ../bachlor-arbeit.tex
Metamaterials are materials with sub-wavelength structure whose physical properties are determined by their internal geometry. They can be engineered to exhibit properties not found in nature like negative refractive indices \cite{Shelby2001}.
For optics the most common architecture are 2D metamaterials called metasurfaces.
Normal optical devices, like lenses or phase plates, leverage chemical material properties and optical effects such as diffraction, refraction or phase differences accumulated over variable propagation lengths.
All these effects rely on distances much larger than one wavelength to change the light's properties.
In contrast, metasurfaces rely on artificial sub-wavelength structures and nano optical effects.
Because of their sub-wavelength thickness they enable thin components not possible before \cite{Yu2014}.
These metasurfaces promise custom optical components which can be tailored to a wide range of applications just by changing geometry of the artificial structures. 
However, because of the sub-wavelength scale, optical metasurfaces with complex geometries are quite hard to manufacture.
Also the optical behavior of metasurfaces is very challenging to model analytically and usually involves computationally intensive simulations which slow down the design process. 
\\

\indent
2016 Menzel and Sperrhake \cite{Menzel2016} presented a \textit{Semi Analytic Stacking Algorithm}, short SASA, to analytically calculate the optical behavior of metasurface stacks if one knows how the surfaces behave individually.
This allows for a different approach when designing novel optical properties.
The idea here is to create a target behavior not by using complex geometry but by using simple metasurfaces and stacking them on top of each other.
The design process becomes an optimization problem of choosing the right surfaces and then tuning stack parameters like the distance between layers and their rotation angle.
This approach is faster because SASA is analytical in nature and many different stacks can be considered very quickly.
However, it also poses some new challenges when trying to automate the process and optimize the properties of a design using a conventional approach.
These usually rely on the continuity of the underlying process so that if a parameter is tuned slightly it is possible to calculate a gradient and tell wether that was a step in the right direction.
This is a problem because some of the choices involved when building a stack are categorical. For example, choosing the material of the layers or the kind of geometry.
\\

\indent
Another recent development has produced a very general and powerful way of dealing with categorical decision problems. Deep Neural Networks have found their way into virtually all areas of life from autonomous driving \cite{Dequaire2016} to video recommendations \cite{youtube}. Given enough data it, should be possible to train a Neural Network to choose the discrete stack parameters to a given optical target.
Again, SASA being analytical is useful because it can be used to generate a lot of training stacks very quickly.
This sets the goal for this work: Write an algorithm which can find a metasurface stack to a custom transmission spectrum and do so by training a Neural Network on data generated by the SASA algorithm.
\\

\indent
The slow and involved process of designing metasurfaces based on numerical methods has led several teams to try and apply the recent advances in machine learning to this problem. Promising results have been published, but they usually yield designs that are too complex to be manufactured for optical wavelengths \cite{Fan2019} or they have very specific optical targets, e.g. a chiral response \cite{Ma2018}. The target algorithm would represent a tool that is simultaneously based on a simple metasurface geometry and capable of solving a common problem. Namely needing a specific transmission spectrum for an application.
\\

\indent
Section \ref{sec:notation} contains a short glossary on the notation used throughout this text.
In section \ref{sec:background} we will first develop the physical theory to understand metasurface stacks and then look into the computer science background of Neural Networks to decide which network architecture fits the problem at hand. 
The Algorithm is described in detail and evaluated in section \ref{sec:algorithm}. We will and on a brief summary and outlook in section \ref{sec:conclusion}.
All the code written for this project is open source and documented thoroughly at \url{https://github.com/TimLucaTuran} and the final tool can be installed as a standard Python package.
